knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(root.dir = "C:/Users/nadir/Desktop/Matching/BKN 599 Advanced Data Analysis")
rm(list = ls());
cat("\014")
graphics.off()
library(tidyverse)
library(Matching)
library(cobalt)
library(pander)
Lthreshold= 15
Hthreshold= 30
setwd("C:/Users/nadir/Desktop/Matching/BKN 599 Advanced Data Analysis")
evalData=read.csv("00042_evalDataset_notext.csv")
patChar= read.csv("PatientCharacteristics_withDose.csv")
rawd= read.csv("Raw Data_Included Subjects Only_mod.csv", sep="\t") # neural values
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(root.dir = "C:/Users/nadir/Desktop/Matching/BKN 599 Advanced Data Analysis")
rm(list = ls());
cat("\014")
graphics.off()
library(tidyverse)
library(Matching)
library(cobalt)
library(pander)
Lthreshold= 15
Hthreshold= 30
setwd("C:/Users/nadir/Desktop/Matching/BKN 599 Advanced Data Analysis")
evalData=read.csv("00042_evalDataset_notext.csv")
patChar= read.csv("PatientCharacteristics_withDose.csv")
rawd= read.csv("Raw Data_Included Subjects Only_mod.csv", sep="\t") # neural values
patChar=rename(patChar, pid= PID )
patChar$RightH.Stroke= ifelse(patChar$CSstrkloc==1, 1, 0)
patChar$LeftH.Stroke= ifelse(patChar$CSstrkloc==2, 1, 0)
evalData1= evalData[-c(1:4, 7:203, 205:245, 247:276, 278:366, 369:375)]
patChar1= patChar[c(3,6,8:10, 12:24,27:32)]
extrafeat= dataMerged= merge(evalData1,patChar1)
evalData= evalData[-c(1:4, 7:203, 205:245, 247:276, 278:366, 369:376)]
patChar= patChar[c(6,9,12,18,19,27,29,30,34,35)]
dataMerged= merge(evalData,patChar)
dataMerged$severity= ifelse(dataMerged$severity=="H", 1, 0)
dataMerged$finished_college=ifelse(dataMerged$DEMOedu>4,1,0)
dataMerged$DEMOedu=NULL
dataMerged[dataMerged == -99] <- NA
for (i in 2:ncol(dataMerged)){
dataMerged[c(i)]= as.numeric(unlist(dataMerged[c(i)]))
}
dataMerged=dataMerged[dataMerged$dose_hours>=Hthreshold | dataMerged$dose_hours<=Lthreshold,]
dataVisit1= subset(dataMerged, visitnum==1)
dataVisit2= subset(dataMerged, visitnum==2)
dataVisit3 = subset(dataMerged, visitnum==3)
dataVisit1= dataVisit1[complete.cases(dataVisit1),]
dataVisit2= dataVisit2[complete.cases(dataVisit2),]
dataVisit3= dataVisit3[complete.cases(dataVisit3),]
temp1= data.frame(dataVisit1$pid);
names(temp1)[1]<-paste("pid");   #renaming column name to "pid"
temp2= data.frame(dataVisit2$pid);
names(temp2)[1]<-paste("pid");   #renaming column name to "pid"
temp3= data.frame(dataVisit3$pid);
names(temp3)[1]<-paste("pid");   #renaming column name to "pid"
temp= merge(temp1,temp2)
temp= merge(temp, temp3)
dataVisit1= merge(temp,dataVisit1)
dataVisit2= merge(temp,dataVisit2)
dataVisit3= merge(temp,dataVisit3)
rm(temp,temp1,temp2,temp3)
sum(is.na(dataVisit1))
sum(is.na(dataVisit2))
sum(is.na(dataVisit3))
data12= dataVisit1
data12$treat=ifelse(dataVisit1$dose_hours<=27, 1, 0)
data12$sishand_change= dataVisit2$SIS_hand-dataVisit1$SIS_hand
data12$fugm_change= dataVisit2$ufugm-dataVisit1$ufugm
data12$logwmftMA_change= dataVisit2$log_mean_time_MA_PA-dataVisit1$log_mean_time_MA_PA
data12$logwmftLA_change= dataVisit2$log_mean_time_LA_PA-dataVisit1$log_mean_time_LA_PA
data12$sishand_retentionv23= dataVisit3$SIS_hand-dataVisit2$SIS_hand
data12$fugm_retentionv23= dataVisit3$ufugm-dataVisit2$ufugm
data12$logwmftMA_retentionv23= dataVisit3$log_mean_time_MA_PA-dataVisit2$log_mean_time_MA_PA
data12$logwmftLA_retentionv23= dataVisit3$log_mean_time_LA_PA-dataVisit2$log_mean_time_LA_PA
rawd=rename(rawd, pid= Study_id )
rawd$pid =toupper(rawd$pid)
rawd2= rawd[c(1,4,7:14,27,31,32,79,133,134)]
dataEXTRA= merge(rawd2,data12[,1:2], by = "pid")
dataEXTRA=dataEXTRA[-c(17)]
extraF= subset(extrafeat, visitnum<2)
dataEXTRA= merge(extraF, dataEXTRA, by = "pid")
dataEXTRA=dataEXTRA[-c(2,13,14)]
dataEXTRA$FCtotalOT=as.numeric(paste(dataEXTRA$FCtotalOT))
dataEXTRA[dataEXTRA == -99] <- NA
# Converting to factors
fnames <- c(8:12,14:22,24,25,27,28,39)
dataEXTRA[,fnames] <- lapply(dataEXTRA[,fnames] , factor)
pander(summary(dataEXTRA))
paste(as.numeric(dataEXTRA$FCtotalOT))
extraOT =paste(as.numeric(dataEXTRA$FCtotalOT))
hist(extraOT)
extraOT =(as.numeric(paste(dataEXTRA$FCtotalOT)))
hist(extraOT)
summary(extraOT)
hist(extraOT,breaks = 21)
sum(extraOT!=0)
sum(extraOT>5)
